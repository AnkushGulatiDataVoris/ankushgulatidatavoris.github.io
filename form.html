<!DOCTYPE html>
<html>
<head>
  <title>Datavoris-Diagnostic Form</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom Modern Styles -->
  <style>
  body {
    background: linear-gradient(135deg, #0A1F44, #0E3A8A);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 40px;
    font-family: Arial, sans-serif;
  }

  .form-container {
    max-width: 600px;
    width: 100%;
    background: #ffffff;
    border-radius: 16px;
    padding: 30px;
    box-shadow: 0 15px 40px rgba(0,0,0,0.25);
    animation: slideUp 0.5s ease;
  }

  @keyframes slideUp {
    from { transform: translateY(50px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }

  .question-card {
    display: none;
  }

  .question-card.active {
    display: block;
    animation: fadeIn 0.5s ease;
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to   { opacity: 1; }
  }

  .btn-next, .btn-back {
    border-radius: 30px;
    padding: 10px 25px;
  }

  .progress {
    height: 10px;
    border-radius: 20px;
    margin-bottom: 20px;
  }

  /* Optional: Make progress bar Datavoris blue */
  #progressBar {
    background-color: #0E3A8A !important;
  }
</style>

</head>

<body>

<div class="form-container">

  <!-- Progress Bar -->
  <div class="progress">
    <div id="progressBar" class="progress-bar bg-primary" style="width: 0%"></div>
  </div>

  <!-- STEP CONTAINER -->
  <div id="stepsContainer">
    
    <!-- Step 1: Basic Information -->
    <div class="question-card active">
      <h3 class="text-center mb-3">Basic Information</h3>

      <form id="diagForm">
        <input class="form-control mb-3" name="name" placeholder="Full Name" required>
        <input class="form-control mb-3" name="email" type="email" placeholder="Email" required>
        <input class="form-control mb-3" name="phone" placeholder="Phone Number" required>

        <button type="button" class="btn btn-primary btn-next w-100 mt-3">Start Assessment</button>
      </form>
    </div>

    <!-- Step 2â€“16: Questions dynamically inserted here -->
  </div>

  <!-- Success Message -->
  <div id="successMsg" class="alert alert-success mt-3 d-none text-center">
    ðŸŽ‰ Your answers have been submitted successfully!
  </div>

</div>

<script>
const questions = [
  "How satisfied are you with growth?",
  "How effective is your teamwork?",
  "How strong is your communication?",
  "Rate customer experience quality.",
  "How strong is your innovation?",
  "How effective is your leadership?",
  "How organized are your processes?",
  "Rate your technology adoption.",
  "How efficient is your operations flow?",
  "Rate your decision-making speed.",
  "How effective is your marketing?",
  "Rate your sales performance.",
  "How strong is your financial clarity?",
  "How aligned is your workforce?",
  "How strong is your execution ability?"
];

const stepsContainer = document.getElementById("stepsContainer");

// Dynamically create 15 steps
questions.forEach((q, i) => {
  stepsContainer.innerHTML += `
    <div class="question-card">
      <h4 class="mb-4">${q}</h4>
      <select class="form-select score mb-4" required>
        <option disabled selected value="">Select score (0â€“10)</option>
        ${[...Array(11)].map((_, s) => `<option value="${s}">${s}</option>`).join("")}
      </select>

      <div class="d-flex justify-content-between mt-3">
        <button class="btn btn-secondary btn-back">Back</button>
        <button class="btn btn-primary btn-next">Next</button>
      </div>
    </div>
  `;
});

// Final Submit Step
stepsContainer.innerHTML += `
  <div class="question-card">
    <h3 class="text-center mb-4">Submit Your Responses</h3>
    <p class="text-center">Click the button below to finish and submit your report.</p>

    <div class="text-center mt-4">
      <button id="submitBtn" class="btn btn-success btn-next w-100">Submit</button>
    </div>
  </div>
`;

let step = 0;
const cards = document.querySelectorAll(".question-card");
const progressBar = document.getElementById("progressBar");

function showStep() {
  cards.forEach(c => c.classList.remove("active"));
  cards[step].classList.add("active");

  let percent = ((step) / (cards.length - 1)) * 100;
  progressBar.style.width = percent + "%";
}

document.addEventListener("click", function(e) {
  if (e.target.classList.contains("btn-next")) {
    if (step < cards.length - 1) step++;
    showStep();
  }

  if (e.target.classList.contains("btn-back")) {
    if (step > 0) step--;
    showStep();
  }
});

// FINAL SUBMIT
document.addEventListener("click", function(e) {
  if (e.target.id === "submitBtn") {
    let form = document.getElementById("diagForm");

    let scores = [...document.querySelectorAll(".score")].map(s => s.value);

    let formData = {
      name: form.name.value,
      email: form.email.value,
      phone: form.phone.value,
      scores: scores
    };

    google.script.run
      .withSuccessHandler(() => {
        document.getElementById("successMsg").classList.remove("d-none");
        step = 0;
        showStep();
        form.reset();
      })
      .submitData(formData);
  }
});
</script>

</body>
</html>
